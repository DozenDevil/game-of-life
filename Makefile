# Компилятор
CC      := gcc

# Флаги компиляции: стандарт C11, предупреждения и ошибки
CFLAGS  := -std=c11 -Wall -Wextra -Werror

# Флаги линковки: подключаем библиотеку ncurses
LDFLAGS := -lncurses

# Имя итогового исполняемого файла
TARGET  := game_of_life

# Список исходных файлов
SRC     := game_of_life.c

# Список объектных файлов, автоматически заменяем расширение .c -> .o
OBJ     := $(SRC:.c=.o)

# Фиксируем, что эти цели не соответствуют реальным файлам
.PHONY: all clean rebuild

# Цель по умолчанию: собираем бинарник
all: $(TARGET)

# Как собрать бинарник из объектных файлов
# $@ = имя цели (game_of_life)
# $(OBJ) = все объектные файлы (.o)
# $(CC) $(CFLAGS) = компилятор с флагами
# $(LDFLAGS) = библиотеки для линковки
$(TARGET): $(OBJ)
	$(CC) $(CFLAGS) $(OBJ) -o $@ $(LDFLAGS)

# Шаблонное правило для сборки .o из .c
# %.o = цель (любой .o файл)
# %.c = зависимость (соответствующий .c файл)
# $< = первая зависимость (исходный файл)
# $@ = цель (объектный файл)
%.o: %.c
	$(CC) $(CFLAGS) -c $< -o $@

# Очистка проекта: удаляем все объектные файлы и бинарник
clean:
	rm -f $(OBJ) $(TARGET)

# Полная пересборка проекта
# make сначала выполняет clean, потом all
# Эта цель не имеет команд сама по себе, она просто выполняет зависимости
rebuild: clean all
